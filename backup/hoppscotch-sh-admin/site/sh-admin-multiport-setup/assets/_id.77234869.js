import{d as se,u as re,g as z,f as D,h as te,i as de,o as h,c as T,k as s,l as ae,Y as me,a5 as pe,ao as ve,n as Q,j as l,m as le,a as u,q as _e,y as ie,ap as Ve,aq as Be,ar as He,e as Pe,r as $e,w as U,t as M,P as Ie,N as Me,as as be,at as We,au as Fe,av as Ke,s as Ce,W as qe,aw as Ye,R as Re,K as fe,L as ze,ax as Qe,ay as Ge,az as De,F as he,a3 as Te,Q as Ze,X as Je,J as Xe,b as et,p as tt,a7 as nt,a8 as ot,x as at}from"./index.38a058b6.js";import{c as ye}from"./index.9173405f.js";import{n as st,e as rt,o as K,M as it,p as lt,q as Ae,r as ct,s as ut,t as dt,f as mt}from"./graphql.96e353c8.js";import{c as pt}from"./clipboard.946f3457.js";import{I as vt,a as _t,b as ft}from"./save.0138baa3.js";import{I as Ee}from"./trash.ccf2245b.js";import{u as ht}from"./usePagedQuery.4d20df8e.js";import{I as yt}from"./plus.02568fcd.js";import{u as Ue}from"./useClientHandler.0626f975.js";import{_ as gt}from"./chevron-down.b8192a8a.js";import{I as bt}from"./user-minus.8c94a8fb.js";import{I as xe}from"./user-plus.af0ab934.js";import{i as Tt}from"./isEqual.9ee97c2e.js";const xt={class:"border rounded divide-y divide-dividerLight border-divider mx-4 my-8"},wt={key:1,class:"divide-y divide-dividerLight"},kt=["placeholder","name","value"],$t=["placeholder","name","value"],It=se({__name:"PendingInvites",props:{team:{}},emits:["update:team"],setup(o,{emit:t}){var x;const e=re(),n=ie(),i=ye(o,"team",t),r=z({get:()=>{var m;return(m=i.value)==null?void 0:m.teamInvitations},set:m=>{i.value.teamInvitations=m}}),d=D(null),C=te(st),R=m=>C.executeMutation({inviteID:m}),v=async(m,E)=>{d.value=E,(await R(m)).error?n.error(e("state.remove_invitee_failure")):r.value&&(r.value=r.value.filter(p=>p.id!==m),n.success(e("state.remove_invitee_success"))),d.value=null},k=(x=Object.create(globalThis.import_meta_env||null).VITE_BASE_URL)!=null?x:"",j=m=>{pt(`${k}/join-team?id=${m}`),n.success(e("state.copied_to_clipboard"))};return(m,E)=>{var G;const $=ve,p=_e,q=de("tippy");return h(),T("div",xt,[s(i)&&((G=r.value)==null?void 0:G.length)===0?(h(),ae($,{key:0,text:"No pending invites"})):(h(),T("div",wt,[(h(!0),T(me,null,pe(r.value,(_,w)=>(h(),T("div",{key:`invitee-${w}`,class:"flex divide-x divide-dividerLight"},[_?(h(),T("input",{key:0,class:"flex flex-1 px-4 py-2 bg-transparent text-secondaryLight",placeholder:s(e)("teams.email_title"),name:"param"+w,value:_.inviteeEmail,readonly:""},null,8,kt)):Q("",!0),l("input",{class:"flex flex-1 px-4 py-2 bg-transparent text-secondaryLight",placeholder:s(e)("teams.permission"),name:"value"+w,value:_.inviteeRole,readonly:""},null,8,$t),le(u(p,{title:s(e)("teams.copy"),icon:s(vt),color:"white",loading:d.value===w,onClick:V=>j(_.id)},null,8,["title","icon","loading","onClick"]),[[q,{theme:"tooltip"}]]),le(u(p,{title:s(e)("teams.remove"),icon:s(Ee),color:"red",loading:d.value===w,onClick:V=>v(_.id,w)},null,8,["title","icon","loading","onClick"]),[[q,{theme:"tooltip"}]])]))),128))]))])}}}),Mt={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ct=l("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3m.08 4h.01"})],-1),Rt=[Ct];function Dt(o,t){return h(),T("svg",Mt,[...Rt])}const Se={name:"lucide-help-circle",render:Dt};var At=He,Et=Be,Ne=Ve,y=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(n[c]=a[c])},o(t,e)};return function(t,e){o(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),we=globalThis&&globalThis.__assign||function(){return we=Object.assign||function(o){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(o[a]=t[a])}return o},we.apply(this,arguments)};globalThis&&globalThis.__spreadArrays;var Ut=At,O=function(o,t,e){return Ut([{value:o,context:t,message:e}])},L=Et,g=function(){function o(t,e,n,a){this.name=t,this.is=e,this.validate=n,this.encode=a,this.decode=this.decode.bind(this)}return o.prototype.pipe=function(t,e){var n=this;return e===void 0&&(e="pipe("+this.name+", "+t.name+")"),new o(e,t.is,function(a,c){var i=n.validate(a,c);return Ne(i)?i:t.validate(i.right,c)},this.encode===A&&t.encode===A?A:function(a){return n.encode(t.encode(a))})},o.prototype.asDecoder=function(){return this},o.prototype.asEncoder=function(){return this},o.prototype.decode=function(t){return this.validate(t,[{key:"",type:this,actual:t}])},o}(),A=function(o){return o};function St(o){return o.displayName||o.name||"<function"+o.length+">"}var Nt=function(o){y(t,o);function t(){var e=o.call(this,"null",function(n){return n===null},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="NullType",e}return t}(g);new Nt;var Lt=function(o){y(t,o);function t(){var e=o.call(this,"undefined",function(n){return n===void 0},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="UndefinedType",e}return t}(g),ke=new Lt,Ot=function(o){y(t,o);function t(){var e=o.call(this,"void",ke.is,ke.validate,A)||this;return e._tag="VoidType",e}return t}(g);new Ot;var jt=function(o){y(t,o);function t(){var e=o.call(this,"unknown",function(n){return!0},L,A)||this;return e._tag="UnknownType",e}return t}(g);new jt;var Vt=function(o){y(t,o);function t(){var e=o.call(this,"string",function(n){return typeof n=="string"},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="StringType",e}return t}(g),Bt=new Vt,Ht=function(o){y(t,o);function t(){var e=o.call(this,"number",function(n){return typeof n=="number"},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="NumberType",e}return t}(g),Le=new Ht,Pt=function(o){y(t,o);function t(){var e=o.call(this,"bigint",function(n){return typeof n=="bigint"},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="BigIntType",e}return t}(g);new Pt;var Wt=function(o){y(t,o);function t(){var e=o.call(this,"boolean",function(n){return typeof n=="boolean"},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="BooleanType",e}return t}(g);new Wt;var Ft=function(o){y(t,o);function t(){var e=o.call(this,"UnknownArray",Array.isArray,function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="AnyArrayType",e}return t}(g);new Ft;var Kt=function(o){y(t,o);function t(){var e=o.call(this,"UnknownRecord",function(n){var a=Object.prototype.toString.call(n);return a==="[object Object]"||a==="[object Window]"},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="AnyDictionaryType",e}return t}(g);new Kt;(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.value=i,r._tag="LiteralType",r}return t})(g);(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.keys=i,r._tag="KeyofType",r}return t})(g);var qt=function(o){y(t,o);function t(e,n,a,c,i,r){var d=o.call(this,e,n,a,c)||this;return d.type=i,d.predicate=r,d._tag="RefinementType",d}return t}(g);function Oe(o,t,e){return je(o,t,e)}Oe(Le,function(o){return Number.isInteger(o)},"Int");var Yt=function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.runDefinition=i,r._tag="RecursiveType",r}return t}(g);Object.defineProperty(Yt.prototype,"type",{get:function(){return this.runDefinition()},enumerable:!0,configurable:!0});(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.type=i,r._tag="ArrayType",r}return t})(g);(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.props=i,r._tag="InterfaceType",r}return t})(g);(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.props=i,r._tag="PartialType",r}return t})(g);(function(o){y(t,o);function t(e,n,a,c,i,r){var d=o.call(this,e,n,a,c)||this;return d.domain=i,d.codomain=r,d._tag="DictionaryType",d}return t})(g);var zt=function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.types=i,r._tag="UnionType",r}return t}(g);(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.types=i,r._tag="IntersectionType",r}return t})(g);(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.types=i,r._tag="TupleType",r}return t})(g);(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.type=i,r._tag="ReadonlyType",r}return t})(g);(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.type=i,r._tag="ReadonlyArrayType",r}return t})(g);(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.type=i,r._tag="ExactType",r}return t})(g);var Qt=function(o){y(t,o);function t(){var e=o.call(this,"Function",function(n){return typeof n=="function"},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="FunctionType",e}return t}(g);new Qt;(function(o){y(t,o);function t(e,n,a,c,i,r){var d=o.call(this,e,n,a,c,i)||this;return d.tag=r,d}return t})(zt);var Gt=function(o){y(t,o);function t(){var e=o.call(this,"never",function(n){return!1},function(n,a){return O(n,a)},function(){throw new Error("cannot encode never")})||this;return e._tag="NeverType",e}return t}(g);new Gt;var Zt=function(o){y(t,o);function t(){var e=o.call(this,"any",function(n){return!0},L,A)||this;return e._tag="AnyType",e}return t}(g);new Zt;var Jt=function(o){y(t,o);function t(){var e=o.call(this,"object",function(n){return n!==null&&typeof n=="object"},function(n,a){return e.is(n)?L(n):O(n,a)},A)||this;return e._tag="ObjectType",e}return t}(g);new Jt;function je(o,t,e){return e===void 0&&(e="("+o.name+" | "+St(t)+")"),new qt(e,function(n){return o.is(n)&&t(n)},function(n,a){var c=o.validate(n,a);if(Ne(c))return c;var i=c.right;return t(i)?L(i):O(i,a)},o.encode,o,t)}je(Le,Number.isInteger,"Integer");(function(o){y(t,o);function t(e,n,a,c,i){var r=o.call(this,e,n,a,c)||this;return r.props=i,r._tag="StrictType",r}return t})(g);const Xt=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,en=Oe(Bt,o=>Xt.test(o),"Email"),tn={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},nn=l("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},null,-1),on=[nn];function an(o,t){return h(),T("svg",tn,[...on])}const X={name:"lucide-circle",render:an},sn={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},rn=l("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[l("circle",{cx:"12",cy:"12",r:"10"}),l("circle",{cx:"12",cy:"12",r:"1"})],-1),ln=[rn];function cn(o,t){return h(),T("svg",sn,[...ln])}const ee={name:"lucide-circle-dot",render:cn},un={key:0,class:"flex items-center justify-center p-4"},dn={key:1,class:"flex flex-col"},mn={class:"flex items-center justify-between flex-1 pt-4"},pn={for:"memberList",class:"p-4"},vn={class:"flex"},_n={class:"border rounded divide-y divide-dividerLight border-divider"},fn=["placeholder","name","value"],hn=["onKeyup"],yn={class:"flex"},gn={key:0,class:"flex flex-col items-start px-4 py-4 mt-4 border rounded border-dividerLight"},bn={class:"flex items-center justify-center px-2 py-1 mb-4 font-semibold border rounded-full bg-primaryDark border-divider"},Tn={class:"text-secondaryLight"},xn={class:"mt-4 space-y-4"},wn={class:"flex"},kn={class:"w-1/4 font-semibold uppercase truncate text-secondaryDark max-w-[4rem]"},$n={class:"flex flex-1"},In={class:"flex"},Mn={class:"w-1/4 font-semibold uppercase truncate text-secondaryDark max-w-[4rem]"},Cn={class:"flex flex-1"},Rn={class:"flex"},Dn={class:"w-1/4 font-semibold uppercase truncate text-secondaryDark max-w-[4rem]"},An={class:"flex flex-1"},En={class:"flex space-x-2"},Un=se({__name:"Invite",props:{show:{type:Boolean},editingTeamID:{}},emits:["hide-modal","member"],setup(o,{emit:t}){const e=re(),n=ie(),a=D(null),c=o,i=t,r=`${Object.create(globalThis.import_meta_env||null).VITE_ADMIN_URL}/assets/images/add_group.svg`,{data:d}=Pe({query:it}),C=z(()=>{var _;return((_=d.value)==null?void 0:_.infra.usersCount)||1e4}),{list:R}=ht(rt,_=>_.infra.allUsers,_=>_.uid,C.value,{cursor:void 0,take:C.value}),v=z(()=>R.value.map(_=>_.email)),k=D([{key:"",value:K.Viewer}]),j=()=>{k.value.push({key:"",value:K.Viewer})},x=(_,w)=>{k.value[_].value=w},m=_=>{k.value.splice(_,1)},E=D(!1),$=async()=>{E.value=!0;const _=be(k.value,Fe(w=>be(w,Ge(V=>en.is(V.key)))),We(Qe(w=>G(w.key,w.value,c.editingTeamID))));if(Ke(_)){n.error(e("users.invalid_user")),E.value=!1;return}p()},p=()=>{E.value=!1,k.value=[{key:"",value:K.Viewer}],i("hide-modal")},q=te(lt),G=async(_,w,V)=>{const W={userEmail:_,role:w,teamID:V},B=await q.executeMutation(W);return B.error?B.error.toString()=="[GraphQL] user/not_found"?n.error(e("state.user_not_found")):n.error(e("state.add_user_failure")):(n.success(e("state.add_user_success")),i("member")),B};return(_,w)=>{const V=Ce,W=_e,B=qe,ne=Ye,f=Re,b=$e("tippy"),I=ve,S=Se,H=fe,Z=ze,ce=de("tippy");return _.show?(h(),ae(Z,{key:0,dialog:"",title:s(e)("teams.add_member"),onClose:p},{body:U(()=>[E.value?(h(),T("div",un,[u(V)])):(h(),T("div",dn,[l("div",mn,[l("label",pn,M(s(e)("teams.add_members")),1),l("div",vn,[u(W,{icon:s(yt),label:s(e)("teams.add_new"),filled:"",onClick:j},null,8,["icon","label"])])]),l("div",_n,[(h(!0),T(me,null,pe(k.value,(P,F)=>(h(),T("div",{key:`new-member-${F}`,class:"flex divide-x divide-dividerLight"},[u(B,{value:P.key,placeholder:s(e)("state.email"),source:v.value,name:"member"+F,spellcheck:!0,styles:`
                w-full pl-3 bg-neutral-900 border-gray-600
              `,class:"flex-1 !flex",onInput:Y=>P.key=Y},null,8,["value","placeholder","source","name","onInput"]),l("span",null,[u(b,{interactive:"",trigger:"click",theme:"popover","on-shown":()=>a.value[F].focus()},{content:U(({hide:Y})=>[l("div",{ref_for:!0,ref_key:"tippyActions",ref:a,class:"flex flex-col focus:outline-none",tabindex:"0",onKeyup:Ie(ue=>Y(),["escape"])},[u(f,{label:s(e)("teams.owner"),icon:P.value==="OWNER"?s(ee):s(X),active:P.value==="OWNER",onClick:()=>{x(F,s(K).Owner),Y()}},null,8,["label","icon","active","onClick"]),u(f,{label:s(e)("teams.editor"),icon:P.value==="EDITOR"?s(ee):s(X),active:P.value==="EDITOR",onClick:()=>{x(F,s(K).Editor),Y()}},null,8,["label","icon","active","onClick"]),u(f,{label:s(e)("teams.viewer"),icon:P.value==="VIEWER"?s(ee):s(X),active:P.value==="VIEWER",onClick:()=>{x(F,s(K).Viewer),Y()}},null,8,["label","icon","active","onClick"])],40,hn)]),default:U(()=>[u(ne,null,{default:U(()=>[l("input",{class:"flex flex-1 px-4 py-2 bg-transparent cursor-pointer",placeholder:s(e)("teams.permissions"),name:"value"+F,value:P.value,readonly:""},null,8,fn)]),_:2},1024)]),_:2},1032,["on-shown"])]),l("div",yn,[le(u(W,{id:"member",title:s(e)("teams.remove"),icon:s(Ee),color:"red",onClick:Y=>m(F)},null,8,["title","icon","onClick"]),[[ce,{theme:"tooltip"}]])])]))),128)),k.value.length===0?(h(),ae(I,{key:0,src:r,alt:s(e)("teams.no_members"),text:s(e)("teams.no_members")},{body:U(()=>[u(W,{label:s(e)("teams.add_new"),filled:"",onClick:j},null,8,["label"])]),_:1},8,["alt","text"])):Q("",!0)]),k.value.length?(h(),T("div",gn,[l("span",bn,[u(S,{class:"mr-2 text-secondaryLight svg-icons"}),Me(" "+M(s(e)("teams.roles")),1)]),l("p",null,[l("span",Tn,M(s(e)("teams.roles_description")),1)]),l("ul",xn,[l("li",wn,[l("span",kn,M(s(e)("teams.owner")),1),l("span",$n,M(s(e)("teams.owner_description")),1)]),l("li",In,[l("span",Mn,M(s(e)("teams.editor")),1),l("span",Cn,M(s(e)("teams.editor_description")),1)]),l("li",Rn,[l("span",Dn,M(s(e)("teams.viewer")),1),l("span",An,M(s(e)("teams.viewer_description")),1)])])])):Q("",!0)]))]),footer:U(()=>[l("span",En,[u(H,{label:s(e)("teams.add_member"),outline:"",onClick:$},null,8,["label"]),u(W,{label:s(e)("teams.cancel"),outline:"",filled:"",onClick:p},null,8,["label"])])]),_:1},8,["title"])):Q("",!0)}}}),Sn={class:"flex flex-col"},Nn={class:"flex flex-col"},Ln={class:"flex"},On={class:"border rounded border-divider my-8"},jn={key:1,class:"divide-y divide-dividerLight"},Vn=["placeholder","name","value"],Bn={class:"relative"},Hn=["placeholder","name","value"],Pn={class:"absolute right-4 top-1/2 transform !-translate-y-1/2"},Wn=["onKeyup"],Fn={class:"flex"},Kn={key:0,class:"flex flex-col items-center"},qn={class:"flex"},Yn=se({__name:"Members",props:{team:{}},emits:["update:team"],setup(o,{emit:t}){const e=re(),n=ie(),a=De(),r=ye(o,"team",t),d=D(!1),{fetchData:C,data:R}=Ue(Ae,{teamID:a.params.id.toString()});he(async()=>{await C()});const v=z(()=>{var f;return(f=R.value)==null?void 0:f.infra.teamInfo}),k=async()=>{!v.value||(await C(),r.value=v.value)},j=D(null),x=D([]),m=D(Te(x.value)),E=z(()=>x.value&&m.value?!Tt(x.value,m.value):!1),$=(f,b)=>{const I=m.value.findIndex(S=>S.userID===f);I!==-1?m.value[I].role=b:m.value.push({userID:f,role:b})},p=z(()=>{var b;return v.value?((b=v.value.teamMembers)!=null?b:[]).map(I=>{var H;const S=m.value.find(Z=>Z.userID===I.user.uid);return{userID:I.user.uid,email:I.user.email,role:(H=S==null?void 0:S.role)!=null?H:I.role}}):[]}),q=te(ct),G=(f,b,I)=>q.executeMutation({userUID:f,teamID:b,newRole:I}),_=D(!1),w=async()=>{if(_.value=!0,!p.value.some(b=>b.role===K.Owner)){n.error(e("state.owner_not_present")),_.value=!1;return}m.value.forEach(async b=>{if(!v.value)return;(await G(b.userID,v.value.id,b.role)).error?n.error(e("state.role_update_failed")):(n.success(e("state.role_update_success")),x.value=m.value,m.value=Te(x.value)),_.value=!1})},V=te(ut),W=(f,b)=>()=>V.executeMutation({userUid:f,teamID:b}),B=D(null),ne=async(f,b)=>{var S;if(!v.value)return;B.value=b;const I=await W(f,v.value.id)();if(I.error){const H=Ze(I.error.message);H?n.error(H):n.error(e("state.remove_member_failure"))}else v.value.teamMembers=(S=v.value.teamMembers)==null?void 0:S.filter(H=>H.user.uid!==f),r.value=v.value,n.success(e("state.remove_member_success"));B.value=null};return(f,b)=>{var ue,ge;const I=fe,S=_e,H=ve,Z=Re,ce=$e("tippy"),P=Se,F=Un,Y=de("tippy");return h(),T("div",Sn,[l("div",Nn,[l("div",Ln,[u(I,{icon:s(xe),label:s(e)("teams.add_members"),filled:"",onClick:b[0]||(b[0]=N=>d.value=!d.value)},null,8,["icon","label"])]),l("div",On,[((ge=(ue=v.value)==null?void 0:ue.teamMembers)==null?void 0:ge.length)===0?(h(),ae(H,{key:0,text:s(e)("teams.no_members")},{body:U(()=>[u(S,{icon:s(xe),label:s(e)("teams.add_members"),onClick:b[1]||(b[1]=()=>{d.value=!d.value})},null,8,["icon","label"])]),_:1},8,["text"])):(h(),T("div",jn,[(h(!0),T(me,null,pe(p.value,(N,J)=>(h(),T("div",{key:`member-${J}`,class:"flex divide-x divide-dividerLight"},[l("input",{class:"flex flex-1 px-4 py-3 bg-transparent",placeholder:s(e)("teams.email_title"),name:"param"+J,value:N.email,readonly:""},null,8,Vn),l("span",null,[u(ce,{interactive:"",trigger:"click",theme:"popover","on-shown":()=>j.value[J].focus()},{content:U(({hide:oe})=>[l("div",{ref_for:!0,ref_key:"tippyActions",ref:j,class:"flex flex-col focus:outline-none",tabindex:"0",onKeyup:Ie(xo=>oe(),["escape"])},[u(Z,{label:s(e)("teams.owner"),icon:N.role==="OWNER"?s(ee):s(X),active:N.role==="OWNER",onClick:()=>{$(N.userID,s(K).Owner),oe()}},null,8,["label","icon","active","onClick"]),u(Z,{label:s(e)("teams.editor"),icon:N.role==="EDITOR"?s(ee):s(X),active:N.role==="EDITOR",onClick:()=>{$(N.userID,s(K).Editor),oe()}},null,8,["label","icon","active","onClick"]),u(Z,{label:s(e)("teams.viewer"),icon:N.role==="VIEWER"?s(ee):s(X),active:N.role==="VIEWER",onClick:()=>{$(N.userID,s(K).Viewer),oe()}},null,8,["label","icon","active","onClick"])],40,Wn)]),default:U(()=>[l("span",Bn,[l("input",{class:"flex flex-1 px-4 py-3 bg-transparent cursor-pointer",placeholder:s(e)("teams.permissions"),name:"value"+J,value:N.role,readonly:""},null,8,Hn),l("span",Pn,[u(s(gt))])])]),_:2},1032,["on-shown"])]),l("div",Fn,[le(u(S,{id:"member",title:s(e)("teams.remove"),icon:s(bt),color:"red",loading:B.value===J,onClick:oe=>ne(N.userID,J)},null,8,["title","icon","loading","onClick"]),[[Y,{theme:"tooltip"}]])])]))),128))]))]),v.value?Q("",!0):(h(),T("div",Kn,[u(P,{class:"mb-4 svg-icons"}),Me(" "+M(s(e)("teams.error")),1)]))]),l("div",qn,[E.value?(h(),ae(I,{key:0,label:s(e)("teams.save_changes"),outline:"",onClick:w},null,8,["label"])):Q("",!0)]),u(F,{show:d.value,team:v.value,editingTeamID:s(a).params.id.toString(),onMember:k,onHideModal:b[2]||(b[2]=()=>{d.value=!1})},null,8,["show","team","editingTeamID"])])}}}),zn={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Qn=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 6h18m-2 0v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6m3 0V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2m-6 5v6m4-6v6"},null,-1),Gn=[Qn];function Zn(o,t){return h(),T("svg",zn,[...Gn])}const Jn={name:"lucide-trash-2",render:Zn},Xn={key:0,class:"flex flex-col"},eo={class:"flex flex-col space-y-8"},to={class:"flex flex-col space-y-3"},no={class:"text-accentContrast",for:"username"},oo={class:"w-full p-3 bg-divider rounded-md"},ao={class:"flex flex-col space-y-3"},so={class:"text-accentContrast",for:"teamname"},ro={key:0,class:"flex flex-col space-y-3"},io={class:"text-accentContrast",for:"username"},lo={class:"w-full p-3 bg-divider rounded-md"},co={class:"flex justify-start mt-8"},uo=se({__name:"Details",props:{team:{}},emits:["update:team","delete-team"],setup(o,{emit:t}){const e=re(),n=ie(),a=o,c=t,i=ye(a,"team",c),r=z({get:()=>i.value.name,set:x=>{i.value.name=x}}),d=D(""),C=z({get:()=>d.value,set:x=>{d.value=x}});he(()=>{d.value=r.value});const R=D(!1),v=te(dt),k=()=>{R.value?r.value!==C.value?j():R.value=!1:R.value=!0},j=async()=>{if(C.value.trim()===""){n.error(e("teams.empty_name"));return}if(C.value.length<6){n.error(e("state.team_name_too_short"));return}const x={uid:i.value.id,name:C.value};(await v.executeMutation(x)).error?n.error(e("state.rename_team_failure")):(R.value=!1,n.success(e("state.rename_team_success")),r.value=C.value)};return(x,m)=>{const E=fe,$=Xe;return s(i)?(h(),T("div",Xn,[l("div",eo,[l("div",to,[l("label",no,M(s(e)("teams.id")),1),l("div",oo,M(s(i).id),1)]),l("div",ao,[l("label",so,M(s(e)("teams.name")),1),l("div",{class:Je(["flex bg-divider rounded-md items-stretch flex-1 border border-divider",{"!border-accent":R.value}])},[u($,{modelValue:C.value,"onUpdate:modelValue":m[0]||(m[0]=p=>C.value=p),styles:"bg-transparent flex-1 rounded-md !rounded-r-none disabled:select-none border-r-0 disabled:cursor-default disabled:opacity-50",placeholder:"Team Name",disabled:!R.value},{button:U(()=>[u(E,{class:"!rounded-l-none",filled:"",icon:R.value?s(_t):s(ft),label:R.value?`${s(e)("teams.rename")}`:`${s(e)("teams.edit")}`,onClick:k},null,8,["icon","label"])]),_:1},8,["modelValue","disabled"])],2)]),s(i).teamMembers.length?(h(),T("div",ro,[l("label",io,M(s(e)("teams.members")),1),l("div",lo,M(s(i).teamMembers.length),1)])):Q("",!0)]),l("div",co,[u(E,{class:"!bg-red-600 !hover:opacity-80",filled:"",label:s(e)("teams.delete_team"),onClick:m[1]||(m[1]=p=>c("delete-team",s(i).id)),icon:s(Jn)},null,8,["label","icon"])])])):Q("",!0)}}}),mo={class:"flex flex-col"},po={key:0,class:"flex justify-center"},vo={key:1,class:"text-lg"},_o={key:2,class:"flex flex-col"},fo={class:"flex items-center space-x-4"},ho={class:"flex justify-center items-center space-x-3"},yo={class:"text-lg text-accentContrast"},go=l("span",null,"/",-1),bo={class:"text-lg text-accentContrast"},To={class:"py-8"},Lo=se({__name:"_id",setup(o){const t=re(),e=ie(),n=De(),a=et(),c=D("details"),i=z(()=>{switch(c.value){case"details":return t("teams.team_details");case"members":return t("teams.team_members_tab");case"invites":return t("teams.pending_invites");default:return""}}),{fetching:r,error:d,data:C,fetchData:R}=Ue(Ae,{teamID:n.params.id.toString()}),v=D();he(async()=>{var $;await R(),v.value=($=C.value)==null?void 0:$.infra.teamInfo});const k=D(!1),j=te(mt),x=D(null),m=$=>{k.value=!0,x.value=$},E=async $=>{if(!$){k.value=!1,e.error(t("state.delete_team_failure"));return}const p={uid:$};(await j.executeMutation(p)).error?e.error(t("state.delete_team_failure")):e.success(t("state.delete_team_success")),k.value=!1,x.value=null,a.push("/teams")};return($,p)=>{const q=Ce,G=tt,_=uo,w=nt,V=Yn,W=It,B=ot,ne=at;return h(),T("div",mo,[s(r)?(h(),T("div",po,[u(q)])):s(d)?(h(),T("div",vo,M(s(t)("teams.load_info_error")),1)):v.value?(h(),T("div",_o,[l("div",fo,[l("button",{class:"p-2 rounded-3xl bg-divider hover:bg-dividerDark transition flex justify-center items-center",onClick:p[0]||(p[0]=f=>s(a).push("/teams"))},[u(G,{class:"text-xl"})]),l("div",ho,[l("h1",yo,M(v.value.name),1),go,l("h2",bo,M(i.value),1)])]),l("div",To,[u(B,{modelValue:c.value,"onUpdate:modelValue":p[4]||(p[4]=f=>c.value=f),"render-inactive-tabs":""},{default:U(()=>[u(w,{id:"details",label:s(t)("teams.details")},{default:U(()=>[u(_,{team:v.value,"onUpdate:team":p[1]||(p[1]=f=>v.value=f),onDeleteTeam:m,class:"py-8 px-4"},null,8,["team"])]),_:1},8,["label"]),u(w,{id:"members",label:s(t)("teams.team_members")},{default:U(()=>[u(V,{team:v.value,"onUpdate:team":p[2]||(p[2]=f=>v.value=f),class:"py-8 px-4"},null,8,["team"])]),_:1},8,["label"]),u(w,{id:"invites",label:s(t)("teams.invites")},{default:U(()=>[u(W,{team:v.value,"onUpdate:team":p[3]||(p[3]=f=>v.value=f)},null,8,["team"])]),_:1},8,["label"])]),_:1},8,["modelValue"]),u(ne,{show:k.value,title:s(t)("teams.confirm_team_deletion"),onHideModal:p[5]||(p[5]=f=>k.value=!1),onResolve:p[6]||(p[6]=f=>E(x.value))},null,8,["show","title"])])])):Q("",!0)])}}});export{Lo as default};
