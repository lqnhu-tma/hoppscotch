import{b as M,c as P}from"./RequestOptions.vue_vue_type_script_setup_true_lang-24406296.js";import{f as L,M as j,i0 as J,h as v,g as O,ae as W,o as y,d as $,e as l,a as m,j as e,Z as T,c as I,m as U,eG as z,cJ as H,v as F,au as K,aY as D,eF as Q,ap as Y,aa as A,cW as X,i1 as Z,hg as E,Y as ee,eR as te,L as w,aj as se,cF as oe,cz as ne,bU as ae}from"./index-7d8b347c.js";import{_ as re}from"./EnvInput-6bb7a0e0.js";import{b as B}from"./route-block-83d24a4e.js";import"./utils-7c6dc436.js";import"./index.es-0a8c9ae4.js";import"./Headers-96f03a77.js";import"./oauth.service-b346be9c.js";import"./json-91191aeb.js";import"./files-905044f3.js";import"./TaskOption-e7d917a4.js";const le={class:"flex flex-col flex-1"},ie={class:"flex items-center justify-between flex-1 flex-shrink-0 px-2 py-2 space-x-2 overflow-x-auto overflow-y-hidden"},ce={class:"flex items-center justify-between flex-1 space-x-2"},ue={class:"flex"},de={class:"sticky top-0 z-10 flex-1"},pe={class:"flex-none flex-shrink-0 p-4 bg-primary sm:flex sm:flex-shrink-0 sm:space-x-2"},me={class:"flex flex-1 overflow-hidden border divide-x rounded text-secondaryDark divide-divider min-w-[12rem] overflow-x-auto border-divider"},fe={class:"flex items-center justify-center px-4 py-2 font-semibold transition rounded-l"},_e={class:"flex items-center flex-1 flex-shrink-0 min-w-0 truncate rounded-r"},ve={class:"flex mt-2 space-x-2 sm:mt-0"},he={class:"flex"},be=L({__name:"index",props:{modelTab:{},properties:{},sharedRequestID:{}},setup(V){const a=j(),h=Y(),f=V,t=J(f,"modelTab"),k=v(f.properties[0]),i=v(null),s=v(!1),u=Object.create(globalThis.import_meta_env||null).VITE_SHORTCODE_BASE_URL??"https://hopp.sh",d=O(()=>`${u}/r/${f.sharedRequestID}`),_=O(()=>t.value.document.request.requestVariables.map(({key:o,value:r})=>({key:o,value:r,secret:!1,sourceEnv:"RequestVariable"}))),{subscribeToStream:q}=W(),p=async()=>{if(g.value===""||/^\s+$/.test(g.value)){h.error(`${a("empty.endpoint")}`);return}C(),s.value=!0;const[o,r]=z(t),c=await r;if(i.value=o,H(c))q(c.right,n=>{s.value&&b(n)},()=>{s.value=!1},()=>{var R;const n=c.right.value;if(n.type==="network_fail"&&((R=n.error)==null?void 0:R.error)==="NO_PW_EXT_HOOK"){const S={type:"extension_error",error:n.error.humanMessage.heading,component:n.error.component,req:n.req};b(S)}s.value=!1});else{s.value=!1,h.error(`${a("error.script_fail")}`);let n;typeof c.left=="string"?n={name:"RequestFailure",message:c.left}:n=c.left,b({type:"script_fail",error:n})}},b=o=>{t.value.document.response=o},g=O(()=>t.value.document.request.endpoint),C=()=>{if(!/^http[s]?:\/\//.test(g.value)&&!g.value.startsWith("<<")){const o=g.value.split(/[/:#?]+/)[0];o==="localhost"||/([0-9]+\.)*[0-9]/.test(o)?t.value.document.request.endpoint="http://"+t.value.document.request.endpoint:t.value.document.request.endpoint="https://"+t.value.document.request.endpoint}},N=()=>{var o;s.value=!1,(o=i.value)==null||o.call(i),b(null)};return(o,r)=>{const c=F,n=re,R=K,S=M,G=P;return y(),$("div",le,[l("header",ie,[l("div",ce,[m(c,{class:"!font-bold uppercase tracking-wide !text-secondaryDark hover:bg-primaryDark focus-visible:bg-primaryDark",label:e(a)("app.name"),to:"https://hoppscotch.io",blank:""},null,8,["label"]),l("div",ue,[m(c,{label:e(a)("app.open_in_hoppscotch"),to:d.value,blank:""},null,8,["label","to"])])])]),l("div",de,[l("div",pe,[l("div",me,[l("span",fe,T(e(t).document.request.method),1),l("div",_e,[m(n,{modelValue:e(t).document.request.endpoint,"onUpdate:modelValue":r[0]||(r[0]=x=>e(t).document.request.endpoint=x),readonly:!0,envs:_.value},null,8,["modelValue","envs"])])]),l("div",ve,[m(R,{id:"send",title:`${e(a)("action.send")} <kbd>${e(D)()}</kbd><kbd>â†©</kbd>`,label:`${s.value?e(a)("action.cancel"):e(a)("action.send")}`,class:"flex-1 min-w-20",outline:"",onClick:r[1]||(r[1]=x=>s.value?N():p())},null,8,["title","label"]),l("div",he,[m(c,{title:`${e(a)("request.save")} <kbd>${e(D)()}</kbd><kbd>S</kbd>`,label:e(a)("request.save"),filled:"",icon:e(Q),class:"flex-1 rounded",blank:"",outline:"",to:d.value},null,8,["title","label","icon","to"])])])])]),m(S,{modelValue:e(t).document.request,"onUpdate:modelValue":r[2]||(r[2]=x=>e(t).document.request=x),"option-tab":k.value,"onUpdate:optionTab":r[3]||(r[3]=x=>k.value=x),properties:o.properties,envs:_.value},null,8,["modelValue","option-tab","properties","envs"]),e(t).document.response?(y(),I(G,{key:0,document:e(t).document,"is-embed":!0},null,8,["document"])):U("",!0)])}}}),xe={class:"flex flex-col justify-center"},ye={key:0,class:"flex justify-center items-center py-5"},ke={key:1,class:"flex flex-1 flex-col items-center justify-center p-8"},qe={class:"heading text-center"},ge={class:"mt-2 text-center"},Re=L({__name:"_id",setup(V){const a=j(),h=A(),f=v(""),t=v(!1),k=v([]),i=X({query:Z,variables:{code:h.params.id.toString()}}),s=v({id:"0",document:{request:E(),response:null,isDirty:!1}});return ee(()=>i.data,()=>{var d,_;if(i.loading)return;const u=i.data;if(H(u)){if(!((d=u.right.shortcode)!=null&&d.request)){t.value=!0;return}const q=JSON.parse((_=u.right.shortcode)==null?void 0:_.request);if(s.value.document.request=te(q,E()),u.right.shortcode&&u.right.shortcode.properties){const p=JSON.parse(u.right.shortcode.properties);p.theme==="dark"?w("BG_COLOR","dark"):p.theme==="light"?w("BG_COLOR","light"):p.theme==="system"&&w("BG_COLOR","system"),k.value=p.options}}}),se(()=>{typeof h.params.id=="string"&&(f.value=h.params.id,i.execute()),t.value=!f.value}),(u,d)=>{const _=ne,q=ae,p=be;return y(),$("div",xe,[e(i).loading?(y(),$("div",ye,[m(_)])):oe(e(i).data)||t.value?(y(),$("div",ke,[m(q,{class:"svg-icons mb-2 opacity-75"}),l("h1",qe,T(e(a)("error.invalid_link")),1),l("p",ge,T(e(a)("error.invalid_embed_link")),1)])):s.value?(y(),I(p,{key:2,modelTab:s.value,"onUpdate:modelTab":d[0]||(d[0]=b=>s.value=b),properties:k.value,"shared-request-i-d":f.value},null,8,["modelTab","properties","shared-request-i-d"])):U("",!0)])}}});typeof B=="function"&&B(Re);export{Re as default};
//# sourceMappingURL=_id-ae0c507a.js.map
