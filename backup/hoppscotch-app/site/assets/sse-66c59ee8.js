import{_ as h}from"./chevron-down-71482dd4.js";import{W as A,_ as P}from"./regex-774f4422.js";import{f as C,M as I,ae as N,af as m,bu as G,bv as V,ai as B,h as M,am as O,Y as U,aj as z,bw as b,al as K,o as W,c as j,w as v,e as l,n as y,ao as _,j as e,an as E,E as H,k as g,Z as Y,a as T,ap as Z,au as q,bx as F,by as J,bz as Q,bA as X,bB as ee,bC as se,bD as te}from"./index-7d8b347c.js";import"./utils-7c6dc436.js";import"./arrow-down-075bb51a.js";import"./json-5c9dc7ca.js";import"./newOutline-83220d1e.js";const oe={class:"sticky top-0 z-10 flex flex-shrink-0 space-x-2 overflow-x-auto bg-primary p-4"},ae={class:"inline-flex flex-1 space-x-2"},ne={class:"flex flex-1"},re=["placeholder","disabled"],le={for:"event-type",class:"truncate border-b border-t border-divider bg-primaryLight px-4 py-2 font-semibold text-secondaryLight"},ie=["disabled"],ve=C({__name:"sse",setup(ce){const t=I(),f=Z(),{subscribeToStream:x}=N(),c=m(V,new G,F),n=B(c.value.connectionState$,"STOPPED"),o=m(Q,"",J),d=m(ee,"",X),u=m(te,[],se),i=M(!0);let p;const k=O(function(){p.postMessage({type:"sse",url:o.value})},1e3);U(o,s=>{s&&k()});const w=({data:s})=>{s.url===o.value&&(i.value=s.result)};z(()=>{p=new A,p.addEventListener("message",w),x(c.value.event$,s=>{switch(s==null?void 0:s.type){case"STARTING":u.value=[{payload:`${t("state.connecting_to",{name:o.value})}`,source:"info",color:"var(--accent-color)",ts:void 0}];break;case"STARTED":u.value=[{payload:`${t("state.connected_to",{name:o.value})}`,source:"info",color:"var(--accent-color)",ts:Date.now()}],f.success(`${t("state.connected")}`);break;case"MESSAGE_RECEIVED":b({payload:s.message,source:"server",ts:s.time});break;case"ERROR":b({payload:t("error.browser_support_sse").toString(),source:"info",color:"#ff5555",ts:s.time});break;case"STOPPED":b({payload:t("state.disconnected_from",{name:o.value}).toString(),source:"disconnected",color:"#ff5555",ts:s.time}),f.error(`${t("state.disconnected")}`);break}})});const S=()=>{if(n.value==="STOPPED")return c.value.start(o.value,d.value);c.value.stop()};K(()=>{p.terminate()});const R=()=>{u.value=[]};return(s,a)=>{const $=q,D=P,L=h;return W(),j(L,{"layout-id":"sse"},{primary:v(()=>[l("div",oe,[l("div",ae,[l("div",ne,[y(l("input",{id:"server","onUpdate:modelValue":a[0]||(a[0]=r=>E(o)?o.value=r:null),type:"url",autocomplete:"off",class:H([{error:!i.value},"flex w-full flex-1 rounded-l border border-divider bg-primaryLight px-4 py-2 text-secondaryDark"]),placeholder:e(t)("sse.url"),disabled:e(n)==="STARTED"||e(n)==="STARTING",onKeyup:a[1]||(a[1]=g(r=>i.value?S():null,["enter"]))},null,42,re),[[_,e(o)]]),l("label",le,Y(e(t)("sse.event_type")),1),y(l("input",{id:"event-type","onUpdate:modelValue":a[2]||(a[2]=r=>E(d)?d.value=r:null),class:"flex w-full flex-1 rounded-r border border-divider bg-primaryLight px-4 py-2 text-secondaryDark",spellcheck:"false",disabled:e(n)==="STARTED"||e(n)==="STARTING",onKeyup:a[3]||(a[3]=g(r=>i.value?S():null,["enter"]))},null,40,ie),[[_,e(d)]])]),T($,{id:"start",disabled:!i.value,name:"start",class:"w-32",label:e(n)==="STARTING"?e(t)("action.starting"):e(n)==="STOPPED"?e(t)("action.start"):e(t)("action.stop"),loading:e(n)==="STARTING",onClick:S},null,8,["disabled","label","loading"])])])]),secondary:v(()=>[T(D,{title:e(t)("sse.log"),log:e(u),onDelete:a[4]||(a[4]=r=>R())},null,8,["title","log"])]),_:1})}}});export{ve as default};
//# sourceMappingURL=sse-66c59ee8.js.map
